# 課題 2 レポート

bb35319015 沖野玄勇

## 課題

住んでる A 県で生まれた（ジモティー）20 代の男性の平均と分散が$\mu_{A}=170.8$,$\sigma^2_{A}={5.43}^2$と公式発表された．また，隣の B 県生まれの男性は，平均と分散が$\mu_{B}=169.7$,$\sigma^2_{B}={5.5}^2$と公式発表されている．このとき，手元の標本の尤もらしさ（尤度）を A 県生まれと B 県生まれについて求めよ．実際にはもちろん A 県・B 県以外の県で生まれる人もいるし，標本の全員が同じ県生まれということはないので，この結果の大小からは何も言えない．

まず`double p_stdnorm(double y)`を，平均 0，分散 1 の正規分布（標準正規分布;$N(0,1)$）における値$y$の出現確率を出力する関数を作成せよ．
良く知られているように，平均 0，分散 1 の正規分布に従う値$y$の出現確率は，

$$
  f(x) = \frac{1}{\sqrt{2\pi}}{\rm e}^{-\frac{x^2}{2}}
$$

である．これを関数化したものが`p_stdnorm`である．

平均$\mu$，分散$\sigma^2$の正規分布（$N(\mu,\sigma^2)$）の確率密度曲線は標準正規分布$N(0,1)$の確率密度曲線と相似である．相似において，$N(0,1)$における$y$が，$N(\mu,\sigma^2)$における$x$に対応しているとすると，$y$は$x$を使って，$y=\dfrac{x-\mu}{\sigma}$と書ける．この操作を$x$の「標準化」という．つまり，どんな正規分布上の変数も$y$を求めるとそれは標準正規分布に従う．

尤度とは，標本$x_1\sim x_N$と仮定分布$p$の類似度をあらわす．仮定分布のもとで標本中のデータのそれぞれが同時に出現する同時確率である．尤度$L$は

$$
L(\theta) = \prod_{i=1}^{N} p(x_i,\theta) = p(x_1,\theta)*p(x_2,\theta)*\dots *p(x_N,\theta)
$$

と計算できる．$p$は仮定した確率密度関数で，$\theta$はその母数．$p$が正規分布なら，$\theta$は，平均$\mu$と分散$\sigma^2$である．

## ソースコードの説明

問題の意味がよくわからなかったが、自分なりに解いてみた。

- まず、A 県での平均と分散を入力させ、次に B 県での平均と分散を入力させる。
- 次から while 文の中に入る。
- まず、z = (val - mu_a) / var_a と val を標準化する。ここで、mu_a は A 県での平均、var_a は分散
- 次に、La = p_stdnorm(z) \* La と書く。La は A 県生まれの尤度とし、La = 1 で初期化している。
- 次に、z = (val - mu_b) / var_b と val を標準化する。ここで、mu_b は B 県での平均、var_b は分散
- 最後に、Lb = p_stdnorm(z) \* Lb と書く。Lb は B 県生まれの尤度とし、Lb = 1 で初期化している。
- あとは、これらを繰り返す。
- プログラムの終わりに La と Lb を表示する

## 入出力結果

```
mu_a = 170.8
var_a = 29.4849
mu_b = 169.7
var_b = 30.25

Likelihood for A：0.000006
Likelihood for B：0.000002
```

## 修正履歴

- ソースコード OK です．
- 未だ「尤度」を習っていないかもしれないので補足すると，尤度とはモデル（平均と分散）への標本データのあてはまり具合です．
  - 課題の解説やソースコードの通り，やっていることは，データ 1 人 1 人の出現確率の同時確率ですよね．独立な事象 A と B の同時確率は P(A,B) = P(A)P(B)で求まります．尤度は，データ全部の同時確率です．
  - どんな平均，分散を与えても尤度が求まりますが，A 県の平均・分散に対する尤度 > B 県の平均・分散に対する尤度　という関係ならば，この標本を B 県出身者（B 県母集団からサンプリングされた標本）と考えるより，A 県出身者だと考えたほうが，もっともらしい（「尤もらしい」），となります．もっと尤度の高い平均・分散の県があれば，そちらの県出身らしいとなるわけです．
  - 同じような求め方で尤度を求めるときに最も尤度が高くなる平均と分散はどのような値だと思いますか？それは，k01 で求めた母集団平均（推定）と母集団分散（推定）です（試してみるとよい）．データそれぞれの出現確率が 1 にはならないので，尤度は 1 にはなりませんが，これが最も大きい尤度にさせる平均と分散です．

[comment #20200624 kotaro]
- レポートが未完成です．出力結果を載せてください．

[comment #20200704]
- A県やB県の平均や分散を入力させるようにしているようですが, その部分も入出力結果に含めて載せてください.  
また, このレポートに載せている結果と, 私が実行した結果が異なったので, もう一度結果を確認してみてください. 

[comment #20200706]
- OKです. 

[comment #20200720 sonoda]
- 課題2の完了を確認
